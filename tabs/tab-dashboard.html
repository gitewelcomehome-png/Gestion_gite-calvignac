<div class="tab-container">
    <!-- En-t√™te avec semaine actuelle -->
    <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 16px 24px; margin-bottom: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h2 style="margin: 0; font-size: 1.5rem;">üìä Tableau de Bord</h2>
                <p id="dashboard-week-info" style="margin: 4px 0 0 0; font-size: 0.9rem; opacity: 1; color: #1a252f;">Semaine en cours</p>
            </div>
            <div style="display: flex; align-items: center; gap: 15px;">
                <button onclick="updateFinancialIndicators()" style="background: rgba(255,255,255,0.2); border: 2px solid white; color: white; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                    üîÑ Actualiser
                </button>
                <div style="text-align: right;">
                    <div id="dashboard-date" style="font-size: 1rem; font-weight: 600;">29 d√©cembre 2025</div>
                    <div id="dashboard-week-number" style="font-size: 0.8rem; opacity: 1; margin-top: 2px; color: #2c3e50;">Semaine 52</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Demandes des clients en attente -->
    <div id="dashboard-demandes-clients" class="card" style="margin-bottom: 20px; border-left: 4px solid #f39c12;">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
            <h3 style="margin: 0; font-size: 1.1rem; color: #2c3e50;">
                ‚è∞ Demandes d'horaires en attente
            </h3>
            <span id="badge-demandes-count" style="background: #f39c12; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600;">0</span>
        </div>
        <div id="liste-demandes-clients" style="display: flex; flex-direction: column; gap: 10px;">
            <!-- Les demandes seront charg√©es ici par JS -->
            <p style="color: #95a5a6; font-style: italic; margin: 0;">Aucune demande en attente</p>
        </div>
    </div>

    <!-- Alertes / Notifications importantes -->
    <div id="dashboard-alerts" style="margin-bottom: 20px;"></div>

    <!-- Indicateurs financiers - Ligne 1 -->
    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px;">
        <!-- URSSAF : 2025 + 2026 -->
        <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 24px; border-radius: 15px; box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);">
            <div style="font-size: 1rem; margin-bottom: 16px; font-weight: 600; opacity: 1; text-align: center; color: #1a252f;">üíº URSSAF</div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <!-- 2025 -->
                <div style="background: rgba(255,255,255,0.15); padding: 16px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 0.75rem; opacity: 1; margin-bottom: 6px;">2025</div>
                    <div id="dashboard-urssaf-2025" style="font-size: 1.6rem; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.1);">-</div>
                    <div style="font-size: 0.65rem; opacity: 1; margin-top: 6px;">Ann√©e pr√©c√©dente</div>
                </div>
                <!-- 2026 -->
                <div style="background: rgba(255,255,255,0.25); padding: 16px; border-radius: 10px; text-align: center; border: 2px solid rgba(255,255,255,0.3);">
                    <div style="font-size: 0.75rem; opacity: 1; margin-bottom: 6px;">2026</div>
                    <div id="dashboard-urssaf-2026" style="font-size: 1.6rem; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.1);">-</div>
                    <div style="font-size: 0.65rem; opacity: 1; margin-top: 6px; color: #666;">En cours</div>
                </div>
            </div>
        </div>

        <!-- IR : 2025 + 2026 -->
        <div class="card" style="background: linear-gradient(135deg, #E74C3C 0%, #C0392B 100%); color: white; padding: 24px; border-radius: 15px; box-shadow: 0 8px 16px rgba(231, 76, 60, 0.3);">
            <div style="font-size: 1rem; margin-bottom: 16px; font-weight: 600; opacity: 1; text-align: center; color: #1a252f;">üßæ IMP√îT SUR LE REVENU</div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <!-- 2025 -->
                <div style="background: rgba(255,255,255,0.15); padding: 16px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 0.75rem; opacity: 1; margin-bottom: 6px;">2025</div>
                    <div id="dashboard-ir-2025" style="font-size: 1.6rem; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.1);">-</div>
                    <div style="font-size: 0.65rem; opacity: 1; margin-top: 6px;">Ann√©e pr√©c√©dente</div>
                </div>
                <!-- 2026 -->
                <div style="background: rgba(255,255,255,0.25); padding: 16px; border-radius: 10px; text-align: center; border: 2px solid rgba(255,255,255,0.3);">
                    <div style="font-size: 0.75rem; opacity: 1; margin-bottom: 6px;">2026</div>
                    <div id="dashboard-ir-2026" style="font-size: 1.6rem; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.1);">-</div>
                    <div style="font-size: 0.65rem; opacity: 1; margin-top: 6px; color: #666;">Estimation</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Indicateurs financiers - Ligne 2 -->
    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 30px;">
        <!-- B√©n√©fice Ann√©e en Cours -->
        <div class="card" style="background: linear-gradient(135deg, #27AE60 0%, #2ECC71 100%); color: white; padding: 24px; text-align: center; border-radius: 15px; box-shadow: 0 8px 16px rgba(39, 174, 96, 0.3);">
            <div style="font-size: 0.85rem; opacity: 1; margin-bottom: 8px; font-weight: 500; color: #1a252f;">B√©n√©fice <span id="annee-benefice">2026</span></div>
            <div id="dashboard-benefice-moyen" style="font-size: 2.2rem; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.1);">-</div>
            <div style="font-size: 0.7rem; opacity: 1; margin-top: 8px; color: #666;">CA - Total Charges</div>
        </div>

        <!-- Tr√©sorerie Actuelle -->
        <div class="card" style="background: linear-gradient(135deg, #3498DB 0%, #2980B9 100%); color: white; padding: 24px; text-align: center; border-radius: 15px; box-shadow: 0 8px 16px rgba(52, 152, 219, 0.3);">
            <div style="font-size: 0.85rem; opacity: 1; margin-bottom: 8px; font-weight: 500; color: #1a252f;">Tr√©sorerie Actuelle</div>
            <div id="dashboard-tresorerie" style="font-size: 2.2rem; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.1);">-</div>
            <div style="font-size: 0.7rem; opacity: 1; margin-top: 8px; color: #666;">Solde bancaire</div>
        </div>
    </div>

    <!-- Graphiques financiers -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
        <!-- B√©n√©fices mensuels des g√Ætes -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">üí∞</span>
                <h3 class="card-title">B√©n√©fices Mensuels des G√Ætes</h3>
            </div>
            <div style="padding: 20px;">
                <canvas id="graphique-benefices-gites" style="max-height: 300px;"></canvas>
            </div>
        </div>

        <!-- Tr√©sorerie -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">üìà</span>
                <h3 class="card-title">√âvolution Tr√©sorerie</h3>
            </div>
            <div style="padding: 20px;">
                <canvas id="graphique-tresorerie-dashboard" style="max-height: 300px;"></canvas>
            </div>
        </div>
    </div>

    <!-- Layout principal : 2 colonnes -->
    <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 30px;">
        
        <!-- COLONNE GAUCHE : R√©servations + M√©nages -->
        <div>
            <!-- R√©servations de la semaine -->
            <div class="card" style="margin-bottom: 30px;">
                <div class="card-header">
                    <span class="card-icon">üìÖ</span>
                    <h3 class="card-title">R√©servations cette semaine</h3>
                </div>
                <div id="dashboard-reservations" style="max-height: 400px; overflow-y: auto;">
                    <p style="text-align: center; color: #999; padding: 40px;">Chargement...</p>
                </div>
            </div>

            <!-- Widget Horaires Clients -->
            <div class="card" style="margin-bottom: 30px;">
                <div class="card-header">
                    <span class="card-icon">‚è∞</span>
                    <h3 class="card-title">Horaires Clients Confirm√©s</h3>
                </div>
                <div id="widget-horaires-clients" style="max-height: 400px; overflow-y: auto; padding: 20px;">
                    <p style="text-align: center; color: #999; padding: 20px;">Chargement...</p>
                </div>
            </div>

            <!-- M√©nages pr√©vus -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üßπ</span>
                    <h3 class="card-title">M√©nages pr√©vus cette semaine <span id="dashboard-cleanings" style="background: #F39C12; color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.85rem; margin-left: 8px;">0</span></h3>
                </div>
                <div id="dashboard-menages" style="max-height: 300px; overflow-y: auto;">
                    <p style="text-align: center; color: #999; padding: 40px;">Chargement...</p>
                </div>
            </div>
        </div>

        <!-- COLONNE DROITE : Todo listes -->
        <div>
            <!-- Todo : Actions R√©servations -->
            <div class="card" style="margin-bottom: 20px; border-left: 4px solid #667eea; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 1.3rem;">‚úÖ</span>
                        <h3 style="font-size: 1.1rem; font-weight: 600; color: #2c3e50; margin: 0;">Actions R√©servations <span id="todo-count-reservations" style="background: #667eea; color: white; padding: 3px 10px; border-radius: 12px; font-size: 0.8rem; margin-left: 8px;">0</span></h3>
                    </div>
                    <button onclick="addTodoItem('reservations')" style="background: #667eea; border: none; color: white; padding: 6px 14px; border-radius: 6px; cursor: pointer; font-size: 1.1rem; transition: all 0.2s;" onmouseover="this.style.background='#5568d3'" onmouseout="this.style.background='#667eea'">+</button>
                </div>
                <div id="todo-reservations" style="padding: 15px; max-height: 250px; overflow-y: auto;">
                    <!-- Todos dynamiques -->
                </div>
            </div>

            <!-- Todo : Travaux par g√Æte -->
            <div class="card" style="margin-bottom: 20px; border-left: 4px solid #F39C12; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 1.3rem;">üîß</span>
                        <h3 style="font-size: 1.1rem; font-weight: 600; color: #2c3e50; margin: 0;">Travaux & Maintenance <span id="todo-count-travaux" style="background: #F39C12; color: white; padding: 3px 10px; border-radius: 12px; font-size: 0.8rem; margin-left: 8px;">0</span></h3>
                    </div>
                    <button onclick="addTodoItem('travaux')" style="background: #F39C12; border: none; color: white; padding: 6px 14px; border-radius: 6px; cursor: pointer; font-size: 1.1rem; transition: all 0.2s;" onmouseover="this.style.background='#e67e22'" onmouseout="this.style.background='#F39C12'">+</button>
                </div>
                <div id="todo-travaux" style="padding: 15px; max-height: 250px; overflow-y: auto;">
                    <!-- Todos dynamiques -->
                </div>
            </div>

            <!-- Todo : Achats -->
            <div class="card" style="border-left: 4px solid #27AE60; box-shadow: 0 2px 4px rgba(0,0,0,0.08);">
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 1.3rem;">üõí</span>
                        <h3 style="font-size: 1.1rem; font-weight: 600; color: #2c3e50; margin: 0;">Achats & Courses <span id="todo-count-achats" style="background: #27AE60; color: white; padding: 3px 10px; border-radius: 12px; font-size: 0.8rem; margin-left: 8px;">0</span></h3>
                    </div>
                    <button onclick="addTodoItem('achats')" style="background: #27AE60; border: none; color: white; padding: 6px 14px; border-radius: 6px; cursor: pointer; font-size: 1.1rem; transition: all 0.2s;" onmouseover="this.style.background='#229954'" onmouseout="this.style.background='#27AE60'">+</button>
                </div>
                <div id="todo-achats" style="padding: 15px; max-height: 250px; overflow-y: auto;">
                    <!-- Todos dynamiques -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Ajout T√¢che -->
<div id="addTodoModal" class="modal">
    <div class="modal-content">
        <div class="card-header">
            <span class="card-icon">üìù</span>
            <h2 class="card-title">Nouvelle T√¢che</h2>
        </div>
        
        <form id="addTodoForm">
            <input type="hidden" id="todoCategory">
            
            <div class="form-group">
                <label>Titre <span class="required">*</span></label>
                <input type="text" id="todoTitle" placeholder="Ex: R√©parer robinet" required>
            </div>
            
            <div class="form-group">
                <label>Description</label>
                <textarea id="todoDescription" rows="3" placeholder="D√©tails suppl√©mentaires..."></textarea>
            </div>
            
            <div id="giteSelectGroup" class="form-group" style="display: none;">
                <label>G√Æte concern√©</label>
                <select id="todoGite">
                    <option value="">Non sp√©cifi√©</option>
                    <option value="Tr√©voux">Tr√©voux</option>
                    <option value="Couzon">Couzon</option>
                </select>
            </div>
            
            <div class="form-group">
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                    <input type="checkbox" id="todoRecurrent" style="width: 18px; height: 18px;">
                    <span>üîÅ T√¢che r√©currente</span>
                </label>
            </div>
            
            <div id="recurrentOptions" style="display: none; margin-left: 26px; margin-top: 10px;">
                <div class="form-group">
                    <label>Fr√©quence</label>
                    <select id="todoFrequency">
                        <option value="weekly">Hebdomadaire</option>
                        <option value="biweekly">Bimensuelle (2 semaines)</option>
                        <option value="monthly">Mensuelle</option>
                    </select>
                </div>
                
                <div id="weeklyOptions" class="form-group">
                    <label>Jour de la semaine</label>
                    <select id="todoWeekday">
                        <option value="1">Lundi</option>
                        <option value="2">Mardi</option>
                        <option value="3">Mercredi</option>
                        <option value="4">Jeudi</option>
                        <option value="5">Vendredi</option>
                        <option value="6">Samedi</option>
                        <option value="0">Dimanche</option>
                    </select>
                </div>
                
                <div id="monthlyOptions" class="form-group" style="display: none;">
                    <label>Jour du mois</label>
                    <input type="number" id="todoDayOfMonth" min="1" max="31" value="1">
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button type="submit" class="btn btn-primary">
                    <span>‚úì</span> Cr√©er
                </button>
                <button type="button" class="btn btn-secondary" onclick="closeAddTodoModal()">
                    Annuler
                </button>
            </div>
        </form>
    </div>
</div>
