<div class="content-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
    <div>
        <h2 style="margin: 0; color: #2c3e50;">üìß Messagerie</h2>
        <p style="margin: 8px 0 0 0; color: #7f8c8d;">Connectez vos comptes de messagerie professionnels</p>
    </div>
</div>

<!-- Section Connexion Messageries -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 30px;">
    
    <!-- Gmail -->
    <div class="card" style="border-left: 4px solid #EA4335; padding: 25px;">
        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
            <svg width="40" height="40" viewBox="0 0 48 48">
                <path fill="#4285F4" d="M45,16.2l-5,2.75l-5,4.75L35,40h7c1.657,0,3-1.343,3-3V16.2z"/>
                <path fill="#34A853" d="M3,16.2l3.614,1.71L13,23.7V40H6c-1.657,0-3-1.343-3-3V16.2z"/>
                <polygon fill="#FBBC04" points="35,11.2 24,19.45 13,11.2 12,17 13,23.7 24,31.95 35,23.7 36,17"/>
                <path fill="#EA4335" d="M3,12.298V16.2l10,7.5V11.2L9.876,8.859C9.132,8.301,8.228,8,7.298,8h0C4.924,8,3,9.924,3,12.298z"/>
                <path fill="#C5221F" d="M45,12.298V16.2l-10,7.5V11.2l3.124-2.341C38.868,8.301,39.772,8,40.702,8h0 C43.076,8,45,9.924,45,12.298z"/>
            </svg>
            <div>
                <h3 style="margin: 0; font-size: 1.1rem; color: #2c3e50;">Gmail</h3>
                <p style="margin: 5px 0 0 0; font-size: 0.85rem; color: #7f8c8d;">Google Workspace</p>
            </div>
        </div>
        <div id="gmail-status" style="padding: 12px; background: #fff3cd; border-radius: 6px; margin-bottom: 15px; font-size: 0.9rem; color: #856404;">
            ‚ö†Ô∏è Non connect√©
        </div>
        <button onclick="connectGmail()" class="btn" style="width: 100%; background: #EA4335; color: white; padding: 12px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
            üîó Connecter Gmail
        </button>
    </div>

    <!-- Outlook -->
    <div class="card" style="border-left: 4px solid #0078D4; padding: 25px;">
        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
            <svg width="40" height="40" viewBox="0 0 48 48">
                <path fill="#0078D4" d="M24,4C12.954,4,4,12.954,4,24s8.954,20,20,20s20-8.954,20-20S35.046,4,24,4z M24,38 c-7.732,0-14-6.268-14-14s6.268-14,14-14s14,6.268,14,14S31.732,38,24,38z"/>
                <path fill="#FFF" d="M24,14c-5.523,0-10,4.477-10,10s4.477,10,10,10s10-4.477,10-10S29.523,14,24,14z M24,30 c-3.314,0-6-2.686-6-6s2.686-6,6-6s6,2.686,6,6S27.314,30,24,30z"/>
            </svg>
            <div>
                <h3 style="margin: 0; font-size: 1.1rem; color: #2c3e50;">Outlook</h3>
                <p style="margin: 5px 0 0 0; font-size: 0.85rem; color: #7f8c8d;">Microsoft 365</p>
            </div>
        </div>
        <div id="outlook-status" style="padding: 12px; background: #fff3cd; border-radius: 6px; margin-bottom: 15px; font-size: 0.9rem; color: #856404;">
            ‚ö†Ô∏è Non connect√©
        </div>
        <button onclick="connectOutlook()" class="btn" style="width: 100%; background: #0078D4; color: white; padding: 12px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
            üîó Connecter Outlook
        </button>
    </div>

    <!-- Autre IMAP -->
    <div class="card" style="border-left: 4px solid #6c757d; padding: 25px;">
        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
            <div style="width: 40px; height: 40px; background: #6c757d; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
                ‚úâÔ∏è
            </div>
            <div>
                <h3 style="margin: 0; font-size: 1.1rem; color: #2c3e50;">Autre IMAP</h3>
                <p style="margin: 5px 0 0 0; font-size: 0.85rem; color: #7f8c8d;">Configuration personnalis√©e</p>
            </div>
        </div>
        <div id="imap-status" style="padding: 12px; background: #fff3cd; border-radius: 6px; margin-bottom: 15px; font-size: 0.9rem; color: #856404;">
            ‚ö†Ô∏è Non configur√©
        </div>
        <button onclick="configureIMAP()" class="btn" style="width: 100%; background: #6c757d; color: white; padding: 12px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
            ‚öôÔ∏è Configurer IMAP
        </button>
    </div>

</div>

<!-- Instructions -->
<div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; margin-bottom: 30px;">
    <h3 style="margin: 0 0 15px 0; display: flex; align-items: center; gap: 10px;">
        <span style="font-size: 1.5rem;">üí°</span>
        Comment √ßa marche ?
    </h3>
    <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
        <li>Cliquez sur le bouton de connexion de votre fournisseur de messagerie</li>
        <li>Autorisez l'acc√®s √† votre compte (OAuth s√©curis√©)</li>
        <li>Vos emails seront synchronis√©s automatiquement</li>
        <li>G√©rez vos r√©servations et communications depuis un seul endroit</li>
    </ul>
</div>

<!-- Placeholder pour future liste d'emails -->
<div id="emailsSection" style="display: none; background: white; padding: 24px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
        <h3 style="margin: 0;">Bo√Æte de r√©ception</h3>
        <button onclick="loadEmails()" class="btn" style="background: #27AE60; color: white; padding: 8px 16px; border: none; border-radius: 6px;">üîÑ Actualiser</button>
    </div>
    <div id="emailsContainer">
        <p style="text-align: center; color: #999; padding: 40px;">Aucun email synchronis√©</p>
    </div>
</div>
</div>

<!-- Info box -->
<div style="margin-top: 24px; padding: 16px; background: #E3F2FD; border-left: 4px solid #3498DB; border-radius: 8px;">
    <h4 style="margin: 0 0 8px 0; color: #3498DB;">üí° Fonctionnalit√©s</h4>
    <ul style="margin: 0; padding-left: 20px; color: #666;">
        <li><strong>Emails :</strong> Visualisez tous vos messages re√ßus et envoy√©s</li>
        <li><strong>R√©ponse rapide :</strong> Utilisez les templates pour r√©pondre en un clic</li>
        <li><strong>Variables :</strong> Personnalisez vos messages avec {{client_name}}, {{gite}}, etc.</li>
        <li><strong>Historique :</strong> Tous vos √©changes sont sauvegard√©s et li√©s aux r√©servations</li>
    </ul>
</div>

<!-- Modal Email -->
<div id="emailModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
    <div style="background: white; padding: 32px; border-radius: 12px; max-width: 800px; width: 90%; max-height: 80vh; overflow-y: auto;">
        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 24px;">
            <div>
                <h3 id="emailModalSubject" style="margin: 0 0 8px 0;"></h3>
                <div style="color: #666; font-size: 0.9rem;">
                    <strong>De:</strong> <span id="emailModalFrom"></span> | 
                    <strong>Date:</strong> <span id="emailModalDate"></span>
                </div>
            </div>
            <button onclick="closeEmailModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">‚úï</button>
        </div>
        <div id="emailModalBody" style="line-height: 1.6; color: #333;"></div>
    </div>
</div>

<!-- Modal R√©ponse -->
<div id="replyModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
    <div style="background: white; padding: 32px; border-radius: 12px; max-width: 800px; width: 90%; max-height: 80vh; overflow-y: auto;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
            <h3 style="margin: 0;">‚úçÔ∏è R√©pondre</h3>
            <button onclick="closeReplyModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">‚úï</button>
        </div>
        
        <div style="margin-bottom: 16px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Template de r√©ponse</label>
            <div style="display: flex; gap: 8px;">
                <select id="templateSelect" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                    <option value="">-- Choisir un template --</option>
                </select>
                <button onclick="applyTemplate()" class="btn" style="background: #3498DB; color: white; padding: 10px 20px; border: none; border-radius: 6px;">Appliquer</button>
            </div>
        </div>
        
        <div style="margin-bottom: 16px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Sujet</label>
            <input type="text" id="replySubject" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;" placeholder="Re: ...">
        </div>
        
        <div style="margin-bottom: 16px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Message</label>
            <textarea id="replyBody" rows="10" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; resize: vertical;" placeholder="Votre r√©ponse..."></textarea>
        </div>
        
        <div style="display: flex; gap: 8px; justify-content: flex-end;">
            <button onclick="closeReplyModal()" class="btn" style="background: #95A5A6; color: white; padding: 10px 20px; border: none; border-radius: 6px;">Annuler</button>
            <button onclick="sendReply()" class="btn" style="background: #27AE60; color: white; padding: 10px 20px; border: none; border-radius: 6px;">üì§ Envoyer</button>
        </div>
    </div>
</div>

