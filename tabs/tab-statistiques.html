<div class="tab-container">
    <!-- Header Style Dashboard -->
    <div class="card" style="background: white; border: 3px solid #2D3436; padding: 20px; margin-bottom: 25px; box-shadow: 4px 4px 0 #2D3436; border-radius: 16px;">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
            <div>
                <h2 style="margin: 0; font-size: 1.5rem; color: #2D3436; font-weight: 700; text-transform: uppercase;">üìä Statistiques</h2>
                <p style="margin: 8px 0 0 0; font-size: 0.9rem; color: #666;">Analyse des performances et r√©servations</p>
            </div>
            <div style="display: flex; gap: 10px; align-items: center;">
                <label for="yearFilterStats" style="font-weight: 600; color: #2D3436; font-size: 0.9rem;">üìÖ Ann√©e :</label>
                <select id="yearFilterStats" onchange="filterStatsByYear()" 
                    style="width: 110px; padding: 8px; border: 2px solid #2D3436; border-radius: 8px; font-size: 0.9rem; text-align: center; font-weight: 600; cursor: pointer; background: white; box-shadow: 2px 2px 0 #2D3436;">
                    <option value="">Chargement...</option>
                </select>
                <button onclick="toggleHistoricalDataForm()" style="background: #74b9ff; color: white; padding: 10px 20px; border: 2px solid #2D3436; border-radius: 10px; cursor: pointer; font-weight: 700; box-shadow: 3px 3px 0 #2D3436; transition: all 0.2s;" onmouseover="this.style.transform='translate(-2px, -2px)'; this.style.boxShadow='5px 5px 0 #2D3436'" onmouseout="this.style.transform=''; this.style.boxShadow='3px 3px 0 #2D3436'">
                    üìÖ G√©rer donn√©es
                </button>
            </div>
        </div>
    </div>

            <!-- üìä R√âSERVATIONS PAR PLATEFORME -->
            <div class="card" style="background: white; border: 3px solid #2D3436; padding: 20px; margin-bottom: 25px; box-shadow: 4px 4px 0 #2D3436; border-radius: 16px;">
                <h3 style="margin: 0 0 20px 0; font-size: 1.2rem; color: #2D3436; font-weight: 700; text-transform: uppercase;">üì± R√©servations par Plateforme</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                    <div style="background: white; border: 3px solid #FF5A5F; padding: 20px; border-radius: 12px; box-shadow: 4px 4px 0 #FF5A5F;">
                        <div style="font-size: 0.875rem; font-weight: 600; color: #FF5A5F; margin-bottom: 8px; text-transform: uppercase;">üè† Airbnb</div>
                        <div id="countAirbnb" style="font-size: 2.5rem; font-weight: 700; color: #2D3436;">-</div>
                        <div style="font-size: 0.8rem; color: #666;">r√©servations</div>
                    </div>
                    <div style="background: white; border: 3px solid #3498DB; padding: 20px; border-radius: 12px; box-shadow: 4px 4px 0 #3498DB;">
                        <div style="font-size: 0.875rem; font-weight: 600; color: #3498DB; margin-bottom: 8px; text-transform: uppercase;">üè° Abritel</div>
                        <div id="countAbritel" style="font-size: 2.5rem; font-weight: 700; color: #2D3436;">-</div>
                        <div style="font-size: 0.8rem; color: #666;">r√©servations</div>
                    </div>
                    <div style="background: white; border: 3px solid #27AE60; padding: 20px; border-radius: 12px; box-shadow: 4px 4px 0 #27AE60;">
                        <div style="font-size: 0.875rem; font-weight: 600; color: #27AE60; margin-bottom: 8px; text-transform: uppercase;">üåæ G√Ætes de France</div>
                        <div id="countGites" style="font-size: 2.5rem; font-weight: 700; color: #2D3436;">-</div>
                        <div style="font-size: 0.8rem; color: #666;">r√©servations</div>
                    </div>
                </div>
            </div>
            
            <!-- üìä TAUX D'OCCUPATION PAR G√éTE -->
            <div class="card" style="background: white; border: 3px solid #667eea; padding: 20px; margin-bottom: 25px; box-shadow: 4px 4px 0 #2D3436; border-radius: 16px;">
                <h3 style="margin: 0 0 20px 0; font-size: 1.2rem; color: #2D3436; font-weight: 700; text-transform: uppercase;">üìä Taux d'Occupation par G√Æte</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px;">
                    <div id="taux-occupation-container" style="display: contents;">
                        <!-- Les cartes de taux d'occupation seront g√©n√©r√©es par JS -->
                    </div>
                </div>
            </div>
            
            <!-- üìà STATISTIQUES AVANC√âES -->
            <div class="card" style="background: white; border: 3px solid #2D3436; padding: 20px; margin-bottom: 25px; box-shadow: 4px 4px 0 #2D3436; border-radius: 16px;">
                <h3 style="margin: 0 0 20px 0; font-size: 1.2rem; color: #2D3436; font-weight: 700; text-transform: uppercase;">üìà Statistiques Avanc√©es</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px;">
                    <!-- Prix moyen nuit√©e -->
                    <div style="background: white; border: 3px solid #27AE60; padding: 20px; border-radius: 12px; box-shadow: 4px 4px 0 #2D3436;">
                        <div style="font-size: 0.75rem; font-weight: 600; color: #666; text-transform: uppercase; margin-bottom: 8px;">üí∞ Prix moyen/nuit</div>
                        <div id="prixMoyen" style="font-size: 2.5rem; font-weight: 700; color: #27AE60;">- ‚Ç¨</div>
                        <div style="font-size: 0.7rem; color: #999;">toutes r√©servations</div>
                    </div>
                    
                    <!-- Dur√©e moyenne s√©jour -->
                    <div style="background: white; border: 3px solid #3498DB; padding: 20px; border-radius: 12px; box-shadow: 4px 4px 0 #2D3436;">
                        <div style="font-size: 0.75rem; font-weight: 600; color: #666; text-transform: uppercase; margin-bottom: 8px;">üìÖ Dur√©e moyenne</div>
                        <div id="dureeMoyenne" style="font-size: 2.5rem; font-weight: 700; color: #3498DB;">- nuits</div>
                        <div style="font-size: 0.7rem; color: #999;">par s√©jour</div>
                    </div>
                    
                    <!-- Meilleur mois -->
                    <div style="background: white; border: 3px solid #f5576c; padding: 20px; border-radius: 12px; box-shadow: 4px 4px 0 #2D3436;">
                        <div style="font-size: 0.75rem; font-weight: 600; color: #666; text-transform: uppercase; margin-bottom: 8px;">üèÜ Meilleur mois</div>
                        <div id="meilleurMois" style="font-size: 1.5rem; font-weight: 700; color: #f5576c;">-</div>
                        <div id="meilleurMoisCA" style="font-size: 1.1rem; color: #27AE60; margin-top: 8px; font-weight: 700;">- ‚Ç¨</div>
                    </div>
                </div>
            </div>
                
                
                <!-- Formulaire cach√© des donn√©es historiques -->
                <div id="historicalDataForm" style="display: none; margin-bottom: 30px;">
                    <div class="card" style="background: linear-gradient(135deg, #f8f9ff 0%, #f0f4ff 100%);">
                        <div style="margin-bottom: 20px;">
                            <h3 style="margin: 0 0 15px 0; color: var(--primary);">üìÖ Donn√©es Historiques (Ann√©es Pr√©c√©dentes)</h3>
                            <div class="alert alert-info" style="margin-bottom: 20px;">
                                <strong>‚ÑπÔ∏è Info :</strong> Saisissez les chiffres d'affaires des ann√©es pr√©c√©dentes pour comparer avec l'ann√©e en cours dans les graphiques.
                            </div>
                            
                            <!-- Champ ann√©e pour la saisie -->
                            <div style="margin-bottom: 20px;">
                                <label style="font-weight: 600; display: block; margin-bottom: 10px;">Ann√©e √† saisir <span style="color: red;">*</span></label>
                                <input type="number" id="historicalYear" placeholder="Ex: 2024" min="2000" max="2050" 
                                    style="width: 150px; padding: 10px; border: 2px solid var(--border); border-radius: 8px; font-weight: 600;">
                                <small style="color: #666; font-size: 0.85rem; margin-left: 10px;">Ann√©e pour laquelle saisir les donn√©es</small>
                            </div>
                        </div>
                        
                        <!-- Tableau Total uniquement -->
                        <div style="overflow-x: auto; margin-bottom: 20px;">
                            <table style="width: 100%; border-collapse: collapse; background: white;">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, var(--primary) 0%, #667eea 100%); color: white;">
                                        <th style="padding: 12px; text-align: left; border: 1px solid #ddd; width: 30%;">Mois</th>
                                        <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">üí∞ Total CA (‚Ç¨)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Cadre bouton commit info -->

                                    <tr>
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Janvier</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_jan" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr style="background: #f8f9fa;">
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">F√©vrier</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_feb" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Mars</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_mar" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr style="background: #f8f9fa;">
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Avril</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_apr" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Mai</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_may" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr style="background: #f8f9fa;">
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Juin</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_jun" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Juillet</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_jul" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr style="background: #f8f9fa;">
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Ao√ªt</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_aug" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Septembre</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_sep" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr style="background: #f8f9fa;">
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Octobre</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_oct" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">Novembre</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_nov" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                    <tr style="background: #f8f9fa;">
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: 600;">D√©cembre</td>
                                        <td style="padding: 10px; border: 1px solid #ddd;">
                                            <input type="number" id="hist_total_dec" placeholder="0" step="0.01" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; text-align: right; background: #fff9e6;">
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button type="button" class="btn btn-success" onclick="saveHistoricalDataTotal()">
                                üíæ Sauvegarder
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="loadHistoricalDataTotal()">
                                üìÇ Charger donn√©es existantes
                            </button>
                            <button type="button" class="btn btn-danger" onclick="deleteHistoricalDataTotal()">
                                üóëÔ∏è Supprimer ann√©e
                            </button>
                        </div>
                        
                        <div id="historicalDataList" style="margin-top: 30px;">
                            <h4 style="color: var(--primary); margin-bottom: 15px;">üìã Ann√©es enregistr√©es</h4>
                            <div id="historicalYearsList"></div>
                        </div>
                    </div>
                </div>
            
            <!-- üí∞ CHIFFRES D'AFFAIRES & R√âSERVATIONS -->
            <div class="card" style="background: white; border: 3px solid #27ae60; padding: 20px; margin-bottom: 25px; box-shadow: 4px 4px 0 #2D3436; border-radius: 16px;">
                <h3 style="margin: 0 0 20px 0; font-size: 1.2rem; color: #2D3436; font-weight: 700; text-transform: uppercase;">üí∞ Chiffres d'Affaires & R√©servations</h3>
                <div style="display: flex; gap: 16px; overflow-x: auto; padding-bottom: 8px;">
                    <div style="background: white; border: 3px solid #2D3436; border-radius: 12px; box-shadow: 4px 4px 0 #2D3436; padding: 20px; min-width: 160px; text-align: center; flex-shrink: 0;">
                        <div style="font-size: 0.75rem; font-weight: 600; color: #666; text-transform: uppercase; margin-bottom: 8px;">Total</div>
                        <div style="font-size: 2.5rem; font-weight: 700; color: #2D3436; margin-bottom: 5px;" id="statTotal">0</div>
                        <div style="font-size: 0.8rem; color: #666;">r√©servations</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: #27ae60; margin-top: 10px;" id="statCA">0 ‚Ç¨</div>
                    </div>
                    
                    <!-- Stats par g√Æte - G√©n√©r√© dynamiquement -->
                    <div id="stats-gites-container" style="display: flex; gap: 16px; flex-shrink: 0;">
                        <!-- Les stats par g√Æte seront g√©n√©r√©es par JS -->
                    </div>
                </div>
            </div>
            
            <!-- üìä COMPARAISON CA MENSUEL -->
            <div class="card" style="background: white; border: 3px solid #667eea; padding: 20px; margin-bottom: 25px; box-shadow: 4px 4px 0 #2D3436; border-radius: 16px;">
                <h3 style="margin: 0 0 20px 0; font-size: 1.2rem; color: #2D3436; font-weight: 700; text-transform: uppercase;">üìä Comparaison CA Mensuel</h3>
                
                <!-- Section s√©lection ann√©es pour comparaison -->
                <div style="margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-radius: 12px; border: 2px solid #e9ecef;">
                    <h4 style="margin: 0 0 15px 0; font-size: 0.95rem; color: #2D3436; font-weight: 600; text-transform: uppercase;">üìÖ Comparer les ann√©es</h4>
                    <div id="yearComparisonCheckboxes" style="display: flex; flex-wrap: wrap; gap: 15px;">
                        <!-- Les checkboxes seront g√©n√©r√©es dynamiquement -->
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="caChart"></canvas>
                </div>
            </div>
        </div>
<script>
// Fonction pour d√©plier/replier la section graphiques
window.toggleSlide = function(slideId) {
    const slide = document.getElementById(slideId);
    const icon = document.getElementById(slideId + '-icon');
    
    if (slide.style.display === 'none') {
        slide.style.display = 'block';
        icon.textContent = '‚ñ≤';
    } else {
        slide.style.display = 'none';
        icon.textContent = '‚ñº';
    }
};

// Event delegation pour les clics sur les titres d√©pliables
document.addEventListener('click', function(e) {
    const target = e.target.closest('[data-slide-target]');
    if (target) {
        const slideId = target.getAttribute('data-slide-target');
        if (slideId) {
            window.toggleSlide(slideId);
        }
    }
});
</script>